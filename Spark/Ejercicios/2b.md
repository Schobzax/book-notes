# M&M - Capítulo 2

Mira te comento

* Max con ordenamiento descendente
* Where con más opciones de estados
* Ejercicio donde se calculen en una misma operación el max, min, avg, count. (Revisar el API)

## Max con Orden descendente

### Python
```
import sys

from pyspark.sql import SparkSession
from pyspark.sql.functions import count, max, min

if __name__ == "__main__":
        if len(sys.argv) != 2:
                print("Usage: mnmcount <file>", file=sys.stderr)
                sys.exit(-1)

        spark = (SparkSession
            .builder
            .appName("PythonMnMCountExtra")
            .getOrCreate())

        mnm_file = sys.argv[1]
        mnm_df = (spark.read.format("csv")
            .option("header","true")
            .option("inferSchema","true")
            .load(mnm_file))

        count_mnm_df = (mnm_df
            .select("State","Color","Count")
            .groupBy("State","Color")
            .agg(max("Count").alias("Max"))
            .orderBy("Max",ascending=True))

        count_mnm_df.show(n=60, truncate=False)
        print("Total Rows = %d" % (count_mnm_df.count()))

        spark.stop()
```
En este sencillo programa mostramos el máximo nº de M&Ms por estado y color. Todos los que se muestran son 100, porque los valores están todos entre 10 y 100.
Incidentalmente, todos los mínimos mostrados son también 10.

### Scala
```

```

## Where con más opciones de estados

### Python

### Scala

## En una misma operación varias funciones agregadas

### Python

### Scala